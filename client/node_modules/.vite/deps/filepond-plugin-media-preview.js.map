{
  "version": 3,
  "sources": ["../../filepond-plugin-media-preview/dist/filepond-plugin-media-preview.esm.js"],
  "sourcesContent": ["/*!\n * FilePondPluginMediaPreview 1.0.11\n * Licensed under MIT, https://opensource.org/licenses/MIT/\n * Please visit undefined for details.\n */\n\n/* eslint-disable */\n\nconst isPreviewableVideo = (file) => /^video/.test(file.type);\n\nconst isPreviewableAudio = (file) => /^audio/.test(file.type);\n\n('use strict');\n\nclass AudioPlayer {\n  constructor(mediaEl, audioElems) {\n    this.mediaEl = mediaEl;\n    this.audioElems = audioElems;\n    this.onplayhead = false;\n    this.duration = 0;\n    this.timelineWidth =\n      this.audioElems.timeline.offsetWidth -\n      this.audioElems.playhead.offsetWidth;\n    this.moveplayheadFn = this.moveplayhead.bind(this);\n\n    this.registerListeners();\n  }\n\n  registerListeners() {\n    this.mediaEl.addEventListener(\n      'timeupdate',\n      this.timeUpdate.bind(this),\n      false\n    );\n    this.mediaEl.addEventListener(\n      'canplaythrough',\n      () => (this.duration = this.mediaEl.duration),\n      false\n    );\n    this.audioElems.timeline.addEventListener(\n      'click',\n      this.timelineClicked.bind(this),\n      false\n    );\n    this.audioElems.button.addEventListener('click', this.play.bind(this));\n    this.audioElems.playhead.addEventListener(\n      'mousedown',\n      this.mouseDown.bind(this),\n      false\n    );\n    window.addEventListener('mouseup', this.mouseUp.bind(this), false);\n  }\n\n  play() {\n    if (this.mediaEl.paused) {\n      this.mediaEl.play();\n    } else {\n      this.mediaEl.pause();\n    }\n    this.audioElems.button.classList.toggle('play');\n    this.audioElems.button.classList.toggle('pause');\n  }\n\n  timeUpdate() {\n    let playPercent = (this.mediaEl.currentTime / this.duration) * 100;\n    this.audioElems.playhead.style.marginLeft = playPercent + '%';\n    if (this.mediaEl.currentTime === this.duration) {\n      this.audioElems.button.classList.toggle('play');\n      this.audioElems.button.classList.toggle('pause');\n    }\n  }\n\n  moveplayhead(event) {\n    let newMargLeft =\n      event.clientX - this.getPosition(this.audioElems.timeline);\n    if (newMargLeft >= 0 && newMargLeft <= this.timelineWidth) {\n      this.audioElems.playhead.style.marginLeft = newMargLeft + 'px';\n    }\n    if (newMargLeft < 0) {\n      this.audioElems.playhead.style.marginLeft = '0px';\n    }\n    if (newMargLeft > this.timelineWidth) {\n      this.audioElems.playhead.style.marginLeft = this.timelineWidth - 4 + 'px';\n    }\n  }\n\n  timelineClicked(event) {\n    this.moveplayhead(event);\n    this.mediaEl.currentTime = this.duration * this.clickPercent(event);\n  }\n\n  mouseDown() {\n    this.onplayhead = true;\n    window.addEventListener('mousemove', this.moveplayheadFn, true);\n    this.mediaEl.removeEventListener(\n      'timeupdate',\n      this.timeUpdate.bind(this),\n      false\n    );\n  }\n\n  mouseUp(event) {\n    window.removeEventListener('mousemove', this.moveplayheadFn, true);\n    if (this.onplayhead == true) {\n      this.moveplayhead(event);\n      // change current time\n      this.mediaEl.currentTime = this.duration * this.clickPercent(event);\n      this.mediaEl.addEventListener(\n        'timeupdate',\n        this.timeUpdate.bind(this),\n        false\n      );\n    }\n    this.onplayhead = false;\n  }\n\n  clickPercent(event) {\n    return (\n      (event.clientX - this.getPosition(this.audioElems.timeline)) /\n      this.timelineWidth\n    );\n  }\n\n  getPosition(el) {\n    return el.getBoundingClientRect().left;\n  }\n}\n\nconst createMediaView = (_) =>\n  _.utils.createView({\n    name: 'media-preview',\n    tag: 'div',\n    ignoreRect: true,\n    create: ({ root, props }) => {\n      const { id } = props;\n\n      // get item\n      const item = root.query('GET_ITEM', { id: props.id });\n      let tagName = isPreviewableAudio(item.file) ? 'audio' : 'video';\n\n      root.ref.media = document.createElement(tagName);\n      root.ref.media.setAttribute('controls', true);\n      root.element.appendChild(root.ref.media);\n\n      if (isPreviewableAudio(item.file)) {\n        let docfrag = document.createDocumentFragment();\n        root.ref.audio = [];\n        (root.ref.audio.container = document.createElement('div')),\n          (root.ref.audio.button = document.createElement('span')),\n          (root.ref.audio.timeline = document.createElement('div')),\n          (root.ref.audio.playhead = document.createElement('div'));\n\n        root.ref.audio.container.className = 'audioplayer';\n        root.ref.audio.button.className = 'playpausebtn play';\n        root.ref.audio.timeline.className = 'timeline';\n        root.ref.audio.playhead.className = 'playhead';\n\n        root.ref.audio.timeline.appendChild(root.ref.audio.playhead);\n        root.ref.audio.container.appendChild(root.ref.audio.button);\n        root.ref.audio.container.appendChild(root.ref.audio.timeline);\n        docfrag.appendChild(root.ref.audio.container);\n\n        root.element.appendChild(docfrag);\n      }\n    },\n    write: _.utils.createRoute({\n      DID_MEDIA_PREVIEW_LOAD: ({ root, props }) => {\n        const { id } = props;\n\n        // get item\n        const item = root.query('GET_ITEM', { id: props.id });\n        if (!item) return;\n\n        let URL = window.URL || window.webkitURL;\n        let blob = new Blob([item.file], { type: item.file.type });\n\n        root.ref.media.type = item.file.type;\n        root.ref.media.src =\n          (item.file.mock && item.file.url) || URL.createObjectURL(blob);\n\n        // create audio player in case of audio file\n        if (isPreviewableAudio(item.file)) {\n          new AudioPlayer(root.ref.media, root.ref.audio);\n        }\n\n        // determine dimensions and update panel accordingly\n        root.ref.media.addEventListener(\n          'loadeddata',\n          () => {\n            let height = 75; // default height for audio panel\n            if (isPreviewableVideo(item.file)) {\n              let containerWidth = root.ref.media.offsetWidth;\n              let factor = root.ref.media.videoWidth / containerWidth;\n              height = root.ref.media.videoHeight / factor;\n            }\n\n            root.dispatch('DID_UPDATE_PANEL_HEIGHT', {\n              id: props.id,\n              height: height,\n            });\n          },\n          false\n        );\n      },\n    }),\n  });\n\nconst createMediaWrapperView = (_) => {\n  /**\n   * Write handler for when preview container has been created\n   */\n  const didCreatePreviewContainer = ({ root, props }) => {\n    const { id } = props;\n    const item = root.query('GET_ITEM', id);\n    if (!item) return;\n\n    // the preview is now ready to be drawn\n    root.dispatch('DID_MEDIA_PREVIEW_LOAD', {\n      id,\n    });\n  };\n\n  /**\n   * Constructor\n   */\n  const create = ({ root, props }) => {\n    const media = createMediaView(_);\n\n    // append media presenter\n    root.ref.media = root.appendChildView(\n      root.createChildView(media, {\n        id: props.id,\n      })\n    );\n  };\n\n  return _.utils.createView({\n    name: 'media-preview-wrapper',\n    create,\n    write: _.utils.createRoute({\n      // media preview stated\n      DID_MEDIA_PREVIEW_CONTAINER_CREATE: didCreatePreviewContainer,\n    }),\n  });\n};\n\n/**\n * Media Preview Plugin\n */\nconst plugin = (fpAPI) => {\n  const { addFilter, utils } = fpAPI;\n  const { Type, createRoute } = utils;\n  const mediaWrapperView = createMediaWrapperView(fpAPI);\n\n  // called for each view that is created right after the 'create' method\n  addFilter('CREATE_VIEW', (viewAPI) => {\n    // get reference to created view\n    const { is, view, query } = viewAPI;\n\n    // only hook up to item view\n    if (!is('file')) {\n      return;\n    }\n\n    // create the media preview plugin, but only do so if the item is video or audio\n    const didLoadItem = ({ root, props }) => {\n      const { id } = props;\n      const item = query('GET_ITEM', id);\n      const allowVideoPreview = query('GET_ALLOW_VIDEO_PREVIEW');\n      const allowAudioPreview = query('GET_ALLOW_AUDIO_PREVIEW');\n\n      if (\n        !item ||\n        item.archived ||\n        ((!isPreviewableVideo(item.file) || !allowVideoPreview) &&\n          (!isPreviewableAudio(item.file) || !allowAudioPreview))\n      ) {\n        return;\n      }\n\n      // set preview view\n      root.ref.mediaPreview = view.appendChildView(\n        view.createChildView(mediaWrapperView, { id })\n      );\n\n      // now ready\n      root.dispatch('DID_MEDIA_PREVIEW_CONTAINER_CREATE', { id });\n    };\n\n    // start writing\n    view.registerWriter(\n      createRoute(\n        {\n          DID_LOAD_ITEM: didLoadItem,\n        },\n        ({ root, props }) => {\n          const { id } = props;\n          const item = query('GET_ITEM', id);\n          const allowVideoPreview = root.query('GET_ALLOW_VIDEO_PREVIEW');\n          const allowAudioPreview = root.query('GET_ALLOW_AUDIO_PREVIEW');\n\n          // don't do anything while not a video or audio file or hidden\n          if (\n            !item ||\n            ((!isPreviewableVideo(item.file) || !allowVideoPreview) &&\n              (!isPreviewableAudio(item.file) || !allowAudioPreview)) ||\n            root.rect.element.hidden\n          )\n            return;\n        }\n      )\n    );\n  });\n\n  // expose plugin\n  return {\n    options: {\n      allowVideoPreview: [true, Type.BOOLEAN],\n      allowAudioPreview: [true, Type.BOOLEAN],\n    },\n  };\n};\n\n// fire pluginloaded event if running in browser, this allows registering the plugin when using async script tags\nconst isBrowser =\n  typeof window !== 'undefined' && typeof window.document !== 'undefined';\nif (isBrowser) {\n  document.dispatchEvent(\n    new CustomEvent('FilePond:pluginloaded', { detail: plugin })\n  );\n}\n\nexport { plugin as default };\n"],
  "mappings": "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",
  "names": []
}
